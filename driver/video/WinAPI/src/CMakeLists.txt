IF ("${CMAKE_SYSTEM_NAME}" STREQUAL "Windows" )
	# bug: cmake cross detection's not implemented, so he never finds anything!
	#FIND_LIBRARY(GDI32_LIBRARY    gdi32)
	#FIND_LIBRARY(OPENGL32_LIBRARY opengl32)
	#FIND_LIBRARY(USER32_LIBRARY   user32)

	
	FIND_PACKAGE(Boost 1.55.0 REQUIRED)
	INCLUDE_DIRECTORIES(../../../src ${Boost_INCLUDE_DIR})

	INCLUDE(AddFileDependencies)
	ADD_FILE_DEPENDENCIES(${PROJECT_SOURCE_DIR}/build_version.cpp ${CMAKE_BINARY_DIR}/build_version_defines.h)

	ADD_DEFINITIONS(-DBUILD_DLL)
	SET(SL_PREFIX "")

	ADD_LIBRARY(videoWinAPI SHARED WinAPI.cpp WinAPI.h main.h ${PROJECT_SOURCE_DIR}/build_version.cpp ../../../src/DriverInterface.cpp)
	ADD_DEPENDENCIES(videoWinAPI updateversion)
	TARGET_LINK_LIBRARIES(videoWinAPI videodrv gdi32 opengl32 user32) 
	
	SET(_OUTPUT_DIR "${CMAKE_BINARY_DIR}/${RTTR_DRIVERDIR}/video")
	SET_TARGET_PROPERTIES(videoWinAPI PROPERTIES
		RUNTIME_OUTPUT_DIRECTORY_RELEASE "${_OUTPUT_DIR}"
		RUNTIME_OUTPUT_DIRECTORY_DEBUG "${_OUTPUT_DIR}"
		RUNTIME_OUTPUT_DIRECTORY_RELWITHDEBINFO "${_OUTPUT_DIR}"
	)
	SET_PROPERTY(TARGET videoWinAPI PROPERTY POSITION_INDEPENDENT_CODE ON)

	INSTALL(TARGETS videoWinAPI RUNTIME DESTINATION ${RTTR_DRIVERDIR}/video)
ENDIF ()
