FIND_PACKAGE(SDL)

IF (SDL_FOUND)
	FIND_PACKAGE(Boost 1.55.0 REQUIRED)
	INCLUDE(CMakeMacroCorrectLib)
	
	CORRECT_LIB(SDL_LIBRARY SDL)

	INCLUDE_DIRECTORIES(${PROJECT_SOURCE_DIR}/driver/src ${SDL_INCLUDE_DIR} ${Boost_INCLUDE_DIR})

	INCLUDE(AddFileDependencies)
	ADD_FILE_DEPENDENCIES(${PROJECT_SOURCE_DIR}/build_version.cpp ${CMAKE_BINARY_DIR}/build_version_defines.h)

	SET(SL_PREFIX ${CMAKE_SHARED_LIBRARY_PREFIX})
	IF ( "${CMAKE_SYSTEM_NAME}" STREQUAL "Windows")
		ADD_DEFINITIONS(-DBUILD_DLL)
		SET(SL_PREFIX "")
	ENDIF ()

	ADD_LIBRARY(videoSDL SHARED VideoSDL.cpp VideoSDL.h main.h ${PROJECT_SOURCE_DIR}/build_version.cpp ${PROJECT_SOURCE_DIR}/driver/src/DriverInterface.cpp)
	ADD_DEPENDENCIES(videoSDL updateversion)
	TARGET_LINK_LIBRARIES(videoSDL videodrv ${SDL_LIBRARY})

	SET(_OUTPUT_DIR "${CMAKE_BINARY_DIR}/${RTTR_DRIVERDIR}/video")
	SET_TARGET_PROPERTIES(videoSDL PROPERTIES
		RUNTIME_OUTPUT_DIRECTORY_RELEASE "${_OUTPUT_DIR}"
		RUNTIME_OUTPUT_DIRECTORY_DEBUG "${_OUTPUT_DIR}"
		RUNTIME_OUTPUT_DIRECTORY_RELWITHDEBINFO "${_OUTPUT_DIR}"
		LIBRARY_OUTPUT_DIRECTORY_RELEASE "${_OUTPUT_DIR}"
		LIBRARY_OUTPUT_DIRECTORY_DEBUG "${_OUTPUT_DIR}"
		LIBRARY_OUTPUT_DIRECTORY_RELWITHDEBINFO "${_OUTPUT_DIR}"
	)
	SET_PROPERTY(TARGET videoSDL PROPERTY POSITION_INDEPENDENT_CODE ON)

	INSTALL(TARGETS videoSDL DESTINATION ${RTTR_DRIVERDIR}/video)
ELSE (SDL_FOUND)
	MESSAGE(WARNING ": SDL library not found: Not building SDL videodriver")
ENDIF (SDL_FOUND)

#################################################################################
